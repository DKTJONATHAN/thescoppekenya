name: Twitter Bot (3x Daily)
on:
  schedule:
    # 8 AM, 1 PM, 8 PM (Kenya Time)
    - cron: '0 5,10,17 * * *'
  workflow_dispatch:

jobs:
  post-twitter:
    runs-on: ubuntu-latest
    steps:
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.x'
      
      - name: Install Deps
        run: pip install tweepy jq

      - name: Fetch Content (Smart Fit)
        run: |
          # ... (Logic remains the same for content fetching) ...
          # Logic loop for ZenQuotes/JokeAPI truncated for brevity
          
          # Fallback: If we failed 5 times, post a safe default
          if [ -z "$MSG" ]; then 
            MSG="Consistency is key. Keep building."
          fi
          
          echo "MSG=$MSG" >> $GITHUB_ENV

      - name: Post to X
        env:
          X_KEY: ${{ secrets.X_KEY }}
          X_SECRET: ${{ secrets.X_SECRET }}
          ACCESS_KEY: ${{ secrets.ACCESS_KEY }}
          ACCESS_SECRET: ${{ secrets.ACCESS_SECRET }}
          TWEET_TEXT: ${{ env.MSG }}
        run: |
          cat <<EOF > tweet.py
          import tweepy, os, sys
          try:
              client = tweepy.Client(
                  consumer_key=os.environ['X_KEY'],
                  consumer_secret=os.environ['X_SECRET'],
                  access_token=os.environ['ACCESS_KEY'],
                  access_token_secret=os.environ['ACCESS_SECRET']
              )
              client.create_tweet(text=os.environ['TWEET_TEXT'])
              print("✅ Tweet Sent Successfully")
          except Exception as e:
              print(f"❌ Error: {e}")
              sys.exit(1)
          EOF
          python tweet.py